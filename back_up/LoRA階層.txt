* 概要
sd-webui-lora-block-weightとか導入すると使えます
Loraを適用する際、強さを階層ごとに設定できます。
顔層だけ適用させるとか、塗りや陰影はいらないから切るとかできるので便利です。

* 導入：sd-webui-lora-block-weight
AUTOMATIC1111's stable-diffusion-webui 用のスクリプト
公式リポジトリのReadmeを読んで導入
https://github.com/hako-mikan/sd-webui-lora-block-weight

* 使い方
公式リポジトリのReadmeを読(略

* 階層について
とりあえず4chan発のやつを貼っときます。
あとで気がついたけど、赤文字の「背景/小物」のうち、&#128314;みたいなマークついてるのが背景にあたる層らしい。
&ref(https://image02.seesaawiki.jp/n/h/nai_ch/GbP5nluAgY.png,500)

* ウェイトの設定

▼LoRAの場合
識別子とウェイトを入力します。 フルモデルと異なり、Loraではエンコーダーを含め17のブロックに分かれています。よって、17個の数値を入力してください。 BASE,IN,OUTなどはフルモデル相当の階層です。
| 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 | 15 | 16 | 17 |
| BASE | IN01 | IN02 | IN04 | IN05 | IN07 | IN08 | MID | OUT03 | OUT04 | OUT05 | OUT06 | OUT07 | OUT08 | OUT09 | OUT10 | OUT11 |

▼LyCORISなどの場合
フルモデル相当の階層になっているので注意です。

| 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 | 15 | 16 | 17 | 18 | 19 | 20 | 21 | 22 | 23 | 24 | 25 | 26 |
| BASE | IN00 | IN01 | IN02 | IN03 | IN04 | IN05 | IN06 | IN07 | IN08 | IN09 | IN10 | IN11 | MID | OUT00 | OUT01 | OUT02 | OUT03 | OUT04 | OUT05 | OUT06 | OUT07 | OUT08 | OUT09 | OUT10 | OUT11 |

* プリセット(LoRA用)
用途別にいい感じの数値設定を貼る。いいのがあったら適当に追加して、どうぞ。

導入したあとに「Weights setting」の「Open TextEditor」を押すと以下のテキストファイルが開かれるのでオリジナルの階層数値設定を追加できます。
"\stable-diffusion-webui\scripts\lbwpresets.txt"

なお、あとでわけがわからなくならないように「呼び出し用」と、「設定値確認用&プロンプト共有用」に以下のように書いておくと良いかもしれないです。
例↓)
F:0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0
F=enable_OUT03-04-05:0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0

**一覧

=|(box=textarea)|
F:0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0
F=enable_OUT03-04-05:0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0
NCNF:1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,0,0
NCNF=disable_OUT03-04-05_OUT10-11:1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,0,0
NF:1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1
NF=disable_OUT03-04-05:1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1
NC:1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0
NC=disable_OUT10-11=:1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0
NPNBASE:0,1,1,1,1,0,0,0,1,1,1,1,1,1,1,0,0
NPNBASE=disable_BASE_IN07-08_MID00_OUY10-11:0,1,1,1,1,0,0,0,1,1,1,1,1,1,1,0,0
NP:1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,0,0
NP=disable_IN07-08_MID00_OUY10-11:1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,0,0
NIN:1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1
NIN=disable_IN-ALL_MID00:1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1
CT:0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0
CT=enable_IN08-MID-OUT03-OUT04:0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0
||=

** カスタムプリセット

識別子: CT
CT:0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0
CT=enable_IN08-MID-OUT03-OUT04:0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0
用途: ポーズとかのLoRAに使うといいかもしれない
とりあえずのけぞりLoRAニキの推奨設定をそのまま載せてます。

識別子: NP
NP:1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,0,0
NP=disable_IN07-08_MID00_OUY10-11:1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,0,0
用途: キャラデザとか維持しながら、モデルのデフォルト傾向の絵柄で生成したいときとか
IN下層とMIDとOUT上層の塗りレイヤーを無効化しています

識別子: NPNBASE
NPNBASE:0,1,1,1,1,0,0,0,1,1,1,1,1,1,1,0,0
NPNBASE=disable_BASE_IN07-08_MID00_OUY10-11:0,1,1,1,1,0,0,0,1,1,1,1,1,1,1,0,0
用途: 
NP+BASE無効化しています

識別子: NF
NF:1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1
NF=disable_OUT03-04-05:1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1
用途：ハイポリLoRAとかで顔がリアルになるのやめてほしいときとか
顔層OUT03-04-05を無効化しています

識別子: F
F:0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0
F=enable_OUT03-04-05:0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0
用途：[[表情にイﾞッ&#9829;フォーカスしたLoRAとかにイﾞイﾞッ&#9829;&#9829;使いイﾞグッ&#9829;>>https://huggingface.co/nnmx/ohogao_lora]]
顔層OUT03-04-05を有効化しています

識別子: NC
NC:1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0
NC=disable_OUT10-11=:1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0
用途: 塗りだけ切りたいとき
OUT上層の塗りレイヤーだけ無効化しています

識別子: NCNF
NCNF:1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,0,0
NCNF=disable_OUT03-04-05_OUT10-11:1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,0,0
用途: 塗りと顔だけ切りたいとき。実写背景LoRAとか使うときにいいかもしれない
顔層と塗り層だけ無効化

識別子: NIN
NIN:1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1
NIN=disable_IN-ALL_MID00:1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1
2023/03/06(月) 
ガビガビキャラLoRAもこのスレにあった層別の1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1適用するとweight:1でもスッキリするで
とのことで、INすべてとMIDを切っている感じです。

** デフォルトプリセット
識別子: OUTD
OUTD:0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0
OUT03-06のみが有効化
用途: キャラLoRAに使ってる人もいるようです
NPとは逆のアプローチで、キャラデザだけを適用する感じの数値設定
